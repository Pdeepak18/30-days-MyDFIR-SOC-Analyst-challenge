# ğŸ§© What is Sysmon? | Day 8  

## ğŸ¯ Objective  
Understand what **Sysmon (System Monitor)** is, its event coverage, and why it is valuable for detecting suspicious activity on Windows systems.  

---

## ğŸ›¡ï¸ What is Sysmon?  
**Sysmon** (System Monitor) is a free tool from Microsoftâ€™s **Sysinternals Suite**.  
It runs as a **Windows service** and logs **detailed system activity** into the Windows Event Log.  

Unlike default Windows logs, Sysmon provides **deep visibility** into:  
- Processes and command lines  
- Network connections with process context  
- File and registry modifications  
- Thread injections and driver loads  

ğŸ“ Location in Event Viewer:  
Applications and Services Logs â†’ Microsoft â†’ Windows â†’ Sysmon â†’ Operational


ğŸ‘‰ Think of Sysmon as a **CCTV camera for Windows**: it doesnâ€™t block attacks, but it records all important activity.  

---

## ğŸ” Key Capabilities  

- âœ… **Process Monitoring** â†’ Detect suspicious executions, parent-child process chains.  
- âœ… **Network Monitoring** â†’ Identify outbound C2 connections, lateral movement.  
- âœ… **Driver/DLL Monitoring** â†’ Detect unsigned or malicious driver/DLL loads.  
- âœ… **Thread Injection & Access** â†’ Spot process tampering and credential theft tools.  
- âœ… **File & Registry Monitoring** â†’ Detect persistence techniques and malware file drops.  
- âœ… **DNS Queries** â†’ Reveal which process is resolving domains (great for detecting malware C2).  

---

## ğŸ§¾ Important Event IDs  

| Event ID | Name | Description |
|----------|------|-------------|
| **1** | Process Creation | Logs new process with command-line, parent info, hash, GUID |
| **3** | Network Connection | Outbound TCP/UDP connections from local processes |
| **6/7** | Driver/Image Load | Detects suspicious or unsigned drivers/DLLs |
| **8** | CreateRemoteThread | Thread injection into another process |
| **10** | Process Access | Process accessing another process handle (e.g., Mimikatz) |
| **11** | File Create | New file created on disk |
| **13** | Registry Value Set | Registry key/value modified (disabled by default) |
| **22** | DNS Query | Captures process-level DNS lookups |

âš ï¸ Some events (Registry, File Streams, Clipboard, WMI) are **disabled by default** due to noise and require a tuned config (e.g., **SwiftOnSecurity Sysmon config**).  

---

## ğŸ”‘ PID vs ProcessGUID  

- **PID (Process ID):** Temporary, reused after process termination.  
- **ProcessGUID:** Unique ID generated by Sysmon. Never reused, reliable for linking events.  

ğŸ‘‰ Example:  
- `cmd.exe` starts (Event ID 1) â†’ ProcessGUID `{ABC-123}`.  
- Same process makes a network connection (Event ID 3) â†’ also tagged with `{ABC-123}`.  
- Analyst can now correlate **process creation â†’ network connection** even if PID changed.  

---

## âš”ï¸ Example Attack Scenario  

1. User opens **malicious.docx** â†’ spawns `winword.exe`.  
   - Sysmon logs **Event ID 1** â†’ ProcessGUID `{111-AAA}`.  

2. `winword.exe` spawns `cmd.exe /c powershell -enc ...`.  
   - Sysmon logs **Event ID 1** â†’ ProcessGUID `{222-BBB}`, parent = Word.  

3. PowerShell connects to attacker server `185.66.77.88:4444`.  
   - Sysmon logs **Event ID 3** â†’ outbound connection tied to `{222-BBB}`.  

ğŸ”— SOC can trace: **Word â†’ CMD â†’ PowerShell â†’ Network Connection** â†’ clear malicious chain.  

---

## ğŸ¤” Interview Quick Q&A  

- **Sysmon vs AV** â†’ AV blocks known malware, Sysmon records evidence.  
- **Sysmon vs EDR** â†’ EDR detects + responds, Sysmon only logs.  
- **Sysmon vs XDR** â†’ XDR correlates across endpoints, network, cloud. Sysmon is endpoint-only.  
- Why is **ProcessGUID better than PID**? â†’ Itâ€™s unique and not reused.  
- Can Sysmon **prevent attacks**? â†’ âŒ No, it only records them.  

---

## ğŸ“Œ Why Use Sysmon?  

- ğŸ” Detect suspicious activity (**malware execution, lateral movement, privilege escalation**)  
- ğŸ§  Hunt anomalies (**unexpected network connections, unsigned driver loads**)  
- ğŸ“¡ Feed logs into **SIEM/EDR pipelines** (Elastic, Splunk, Wazuh, Sentinel)  
- ğŸ§© Enables **behavior-based detection** beyond signature-based AV  
- âš™ï¸ Highly tunable with custom XML configs (e.g., **SwiftOnSecurity config**)  

---

## ğŸ“˜ Summary  

**Sysmon** is a lightweight but powerful logging tool for Windows.  
It provides **deep visibility** into process, network, registry, and file activity, enabling SOC analysts to:  

- Detect advanced threats  
- Correlate suspicious activity with **ProcessGUID**  
- Feed high-value logs into SIEM/EDR pipelines  

ğŸ‘‰ In short:  
**Sysmon = Visibility layer that helps SOC teams catch what normal Windows logs miss.**  
