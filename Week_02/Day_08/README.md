# 🧩 What is Sysmon? | Day 8  

## 🎯 Objective  
Understand what **Sysmon (System Monitor)** is, its event coverage, and why it is valuable for detecting suspicious activity on Windows systems.  

---

## 🛡️ What is Sysmon?  
**Sysmon** (System Monitor) is a free tool from Microsoft’s **Sysinternals Suite**.  
It runs as a **Windows service** and logs **detailed system activity** into the Windows Event Log.  

Unlike default Windows logs, Sysmon provides **deep visibility** into:  
- Processes and command lines  
- Network connections with process context  
- File and registry modifications  
- Thread injections and driver loads  

📍 Location in Event Viewer:  
Applications and Services Logs → Microsoft → Windows → Sysmon → Operational


👉 Think of Sysmon as a **CCTV camera for Windows**: it doesn’t block attacks, but it records all important activity.  

---

## 🔍 Key Capabilities  

- ✅ **Process Monitoring** → Detect suspicious executions, parent-child process chains.  
- ✅ **Network Monitoring** → Identify outbound C2 connections, lateral movement.  
- ✅ **Driver/DLL Monitoring** → Detect unsigned or malicious driver/DLL loads.  
- ✅ **Thread Injection & Access** → Spot process tampering and credential theft tools.  
- ✅ **File & Registry Monitoring** → Detect persistence techniques and malware file drops.  
- ✅ **DNS Queries** → Reveal which process is resolving domains (great for detecting malware C2).  

---

## 🧾 Important Event IDs  

| Event ID | Name | Description |
|----------|------|-------------|
| **1** | Process Creation | Logs new process with command-line, parent info, hash, GUID |
| **3** | Network Connection | Outbound TCP/UDP connections from local processes |
| **6/7** | Driver/Image Load | Detects suspicious or unsigned drivers/DLLs |
| **8** | CreateRemoteThread | Thread injection into another process |
| **10** | Process Access | Process accessing another process handle (e.g., Mimikatz) |
| **11** | File Create | New file created on disk |
| **13** | Registry Value Set | Registry key/value modified (disabled by default) |
| **22** | DNS Query | Captures process-level DNS lookups |

⚠️ Some events (Registry, File Streams, Clipboard, WMI) are **disabled by default** due to noise and require a tuned config (e.g., **SwiftOnSecurity Sysmon config**).  

---

## 🔑 PID vs ProcessGUID  

- **PID (Process ID):** Temporary, reused after process termination.  
- **ProcessGUID:** Unique ID generated by Sysmon. Never reused, reliable for linking events.  

👉 Example:  
- `cmd.exe` starts (Event ID 1) → ProcessGUID `{ABC-123}`.  
- Same process makes a network connection (Event ID 3) → also tagged with `{ABC-123}`.  
- Analyst can now correlate **process creation → network connection** even if PID changed.  

---

## ⚔️ Example Attack Scenario  

1. User opens **malicious.docx** → spawns `winword.exe`.  
   - Sysmon logs **Event ID 1** → ProcessGUID `{111-AAA}`.  

2. `winword.exe` spawns `cmd.exe /c powershell -enc ...`.  
   - Sysmon logs **Event ID 1** → ProcessGUID `{222-BBB}`, parent = Word.  

3. PowerShell connects to attacker server `185.66.77.88:4444`.  
   - Sysmon logs **Event ID 3** → outbound connection tied to `{222-BBB}`.  

🔗 SOC can trace: **Word → CMD → PowerShell → Network Connection** → clear malicious chain.  

---

## 🤔 Interview Quick Q&A  

- **Sysmon vs AV** → AV blocks known malware, Sysmon records evidence.  
- **Sysmon vs EDR** → EDR detects + responds, Sysmon only logs.  
- **Sysmon vs XDR** → XDR correlates across endpoints, network, cloud. Sysmon is endpoint-only.  
- Why is **ProcessGUID better than PID**? → It’s unique and not reused.  
- Can Sysmon **prevent attacks**? → ❌ No, it only records them.  

---

## 📌 Why Use Sysmon?  

- 🔍 Detect suspicious activity (**malware execution, lateral movement, privilege escalation**)  
- 🧠 Hunt anomalies (**unexpected network connections, unsigned driver loads**)  
- 📡 Feed logs into **SIEM/EDR pipelines** (Elastic, Splunk, Wazuh, Sentinel)  
- 🧩 Enables **behavior-based detection** beyond signature-based AV  
- ⚙️ Highly tunable with custom XML configs (e.g., **SwiftOnSecurity config**)  

---

## 📘 Summary  

**Sysmon** is a lightweight but powerful logging tool for Windows.  
It provides **deep visibility** into process, network, registry, and file activity, enabling SOC analysts to:  

- Detect advanced threats  
- Correlate suspicious activity with **ProcessGUID**  
- Feed high-value logs into SIEM/EDR pipelines  

👉 In short:  
**Sysmon = Visibility layer that helps SOC teams catch what normal Windows logs miss.**  
